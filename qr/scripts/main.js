var SuggestionComponent=React.createClass({displayName:"SuggestionComponent",handleSelect:function(){this.props.handleSelect(this.props.itemID)},render:function(){var e=this.props.suggestion.toLowerCase().indexOf(this.props.highlight.toLowerCase()),t=this.props.suggestion.substring(0,e),s=this.props.suggestion.substring(e,e+this.props.highlight.length),a=this.props.suggestion.substring(t.length+s.length);return React.DOM.a({onClick:this.handleSelect,className:"suggest list-group-item",href:"#"},t,React.DOM.strong(null,s),a)}}),selectedItemComponent=React.createClass({displayName:"selectedItemComponent",handleIconClick:function(){this.props.handleDelete(this.props.itemID)},render:function(){return React.DOM.div(null,React.DOM.a({href:"#",onClick:this.handleIconClick},React.DOM.span({className:"glyphicon glyphicon-minus pull-right"})),this.props.text)}}),CategoryComponent=React.createClass({displayName:"CategoryComponent",getInitialState:function(){return{inputValue:""}},handleChange:function(e){this.setState({inputValue:e.target.value})},handleSelect:function(e){this.props.handleSelect(this.props.cat,e),this.setState({inputValue:""})},handleDelete:function(e){this.props.handleDelete(this.props.cat,e)},handleXClick:function(){this.setState({inputValue:""})},getSuggestions:function(e){if(""==e)return[];var t=this.props.data,s=this.props.selected,a=0,n=[];for(i in t){if(5==a)return n;var l=parseInt(i);if(-1==s.indexOf(l)){var c=t[l];c.toLowerCase().indexOf(e.toLowerCase())>-1&&(n[l]=c,a+=1)}}return n},render:function(){var e=null;if(""!=this.state.inputValue){var t=this.getSuggestions(this.state.inputValue),s=t.map(function(e,t){return SuggestionComponent({key:t,highlight:this.state.inputValue,suggestion:e,itemID:t,handleSelect:this.handleSelect})}.bind(this));e=React.DOM.div({className:"list-group suggest"},s)}var a=[];for(i in this.props.selected){var n=this.props.selected[i],l=this.props.data[n];a.push(React.DOM.tr({key:i},React.DOM.td(null,selectedItemComponent({text:l,itemID:n,handleDelete:this.handleDelete}))))}return React.DOM.div(null,React.DOM.div(null,React.DOM.input({value:this.state.inputValue,onChange:this.handleChange,type:"text",className:"form-control input-lg"}),React.DOM.a({href:"#",style:{visibility:""==this.state.inputValue?"hidden":"visible"},onClick:this.handleXClick},React.DOM.span({className:"on-input glyphicon glyphicon-remove pull-right"}))),e,React.DOM.hr(null),React.DOM.h5(null,"My Selections:"),React.DOM.table({className:"table table-bordered table-striped"},React.DOM.tbody(null,a)))}}),QRComponent=React.createClass({displayName:"QRComponent",paintQR:function(e){qr.image({image:this.refs.img.getDOMNode(),value:e,size:6,level:"Q"})},componentDidMount:function(){this.paintQR(this.props.str)},componentWillReceiveProps:function(e){this.paintQR(e.str)},handleClick:function(){qr.save({mime:"image/png",path:"qr.png",value:this.props.str,size:6,level:"Q"},function(e){if(e)throw e})},render:function(){return React.DOM.div(null,React.DOM.img({ref:"img",id:"qr-code"}),React.DOM.hr(null),React.DOM.div(null,React.DOM.a({href:"#",onClick:this.handleClick,className:"btn btn-success"},"Download Image")),React.DOM.hr(null),React.DOM.h5(null,"QR Data:"),React.DOM.pre(null,this.props.str))}}),TopLevelComponent=React.createClass({displayName:"TopLevelComponent",getInitialState:function(){return{db:{1:[],2:[],3:[]},selected:{1:[],2:[],3:[]}}},componentDidMount:function(){var e=this.state.db;$.get("../data.csv",function(t){var s=t.split("\n");for(i in s){var a=s[i];if(""==a)break;var n=a.split(","),l=parseInt(n[0]),c=parseInt(n[1]),r=n[2];e[l][c]=r}this.setState({db:e})}.bind(this))},handleSelect:function(e,t){var s=this.state.selected;-1==s[e].indexOf(t)&&(s[e].push(t),this.setState({selected:s}))},handleDelete:function(e,t){var s=this.state.selected,a=s[e].indexOf(t);a>-1&&(s[e].splice(a,1),this.setState({selected:s}))},render:function(){var e="";for(i in this.state.selected)for(j in this.state.selected[i]){var t=this.state.selected[i][j];e=e+t.toString()+","}return e=e.substring(0,e.length-1),React.DOM.div(null,React.DOM.div({className:"page-header"},React.DOM.h1(null,"Our Nice QR Generator",React.DOM.small(null," | Generating codes since 1998"))),React.DOM.div({className:"row"},React.DOM.div({className:"col-sm-3"},React.DOM.div({className:"progress line"},React.DOM.div({className:"progress-bar"})),React.DOM.h3(null,"Category 1"),React.DOM.hr(null),CategoryComponent({cat:1,data:this.state.db[1],selected:this.state.selected[1],handleSelect:this.handleSelect,handleDelete:this.handleDelete})),React.DOM.div({className:"col-sm-3"},React.DOM.div({className:"progress line"},React.DOM.div({className:"progress-bar progress-bar-success"})),React.DOM.h3(null,"Category 2"),React.DOM.hr(null),CategoryComponent({cat:2,data:this.state.db[2],selected:this.state.selected[2],handleSelect:this.handleSelect,handleDelete:this.handleDelete})),React.DOM.div({className:"col-sm-3"},React.DOM.div({className:"progress line"},React.DOM.div({className:"progress-bar progress-bar-danger"})),React.DOM.h3(null,"Category 3"),React.DOM.hr(null),CategoryComponent({cat:3,data:this.state.db[3],selected:this.state.selected[3],handleSelect:this.handleSelect,handleDelete:this.handleDelete})),React.DOM.div({className:"col-sm-3 qr"},React.DOM.div({className:"progress line"},React.DOM.div({className:"progress-bar progress-bar-warning"})),React.DOM.h3(null,"Generated QR code"),React.DOM.hr(null),QRComponent({str:e}))))}});React.renderComponent(TopLevelComponent(null),document.getElementById("topLevel"));